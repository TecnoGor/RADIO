!function(t){"use strict";var e,i,s="jquery-stickit",o=s+"-spacer",n=":"+s,h=-1!=navigator.userAgent.indexOf("MSIE 7.0"),a=h?-2:0,r=void 0!==window.MutationObserver,l=window.StickScope={Parent:0,Document:1},c=0,p=1,d=2,f=!1,g=!1;function u(e,i){this.element=t(e),this.lastValues={},t.isArray(i)||(i=[i||{}]),i.length||i.push({}),this.optionList=i;var s=this.element.css("transform")||"";this.defaultZIndex=this.element.css("z-index")||100,("auto"==this.defaultZIndex||"0"==this.defaultZIndex&&"none"!=s)&&(this.defaultZIndex=100),this.updateOptions(),this.offsetY=0,this.lastY=0,this.stick=c,this.spacer=t("<div />"),this.spacer[0].id=e.id,this.spacer[0].className=e.className,this.spacer[0].style.cssText=e.style.cssText,this.spacer.addClass(o),this.spacer[0].style.cssText+=";visibility: hidden !important;display: none !important",this.spacer.insertAfter(this.element),"static"==this.element.parent().css("position")&&this.element.parent().css("position","relative"),this.origWillChange=this.element.css("will-change"),"auto"==this.origWillChange&&this.element.css("will-change","transform"),"none"==s?this.element.css("transform","translateZ(0)"):-1==s.indexOf("matrix3d")&&this.element.css("transform",this.element.css("transform")+" translateZ(0)"),this.bound(),this.precalculate(),this.store()}function m(){e=window.innerHeight||document.documentElement.clientHeight,i=window.innerWidth||document.documentElement.clientWidth,b()}function b(){g=!0,t(n).each((function(){t(this).data(s).refresh()})),setTimeout((function(){g=!1}))}function x(){g=!0,t(n).each((function(){t(this).data(s).locate()})),setTimeout((function(){g=!1}))}function y(){var e=!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement);t(n).each((function(){t(this).data(s).enableWillChange(!e)}))}function v(t){g||b()}t.expr[":"][s]=function(e){return!!t(e).data(s)},u.prototype.trigger=function(t){var e="on"+t.charAt(0).toUpperCase()+t.slice(1);this.options[e]&&this.options[e].call(this.element),this.element.trigger("stickit:"+t)},u.prototype.isActive=function(t){return(void 0===t.screenMinWidth||i>=t.screenMinWidth)&&(void 0===t.screenMaxWidth||i<=t.screenMaxWidth)},u.prototype.updateCss=function(t){this.element.hasClass(this.options.className)&&t.className!=this.options.className&&this.element.removeClass(this.options.className).addClass(t.className);var e={};this.stick==d?this.options.extraHeight!=t.extraHeight&&(e.bottom=-this.options.extraHeight+"px"):this.options.top!=t.top&&(e.top=t.top+this.offsetY+"px"),this.options.zIndex!=t.zIndex&&(e.zIndex=this.getZIndex(t)),this.element.css(e)},u.prototype.updateOptions=function(){var t=this.getActiveOptionsKey();if(this.activeKey!=t){this.activeKey=t;var e=this.getActiveOptions();this.options&&(t?this.stick!=c&&(e.scope==this.options.scope?this.updateCss(e):(this.reset(),setTimeout(this.locate.bind(this)))):this.reset()),this.options=e,this.zIndex=this.getZIndex(e)}},u.prototype.getZIndex=function(t){return void 0===t.zIndex?this.defaultZIndex:t.zIndex},u.prototype.getActiveOptionsKey=function(){for(var t=[],e=0;e<this.optionList.length;++e)this.isActive(this.optionList[e])&&t.push(e);return t.join("_")},u.prototype.getActiveOptions=function(){for(var e={},i=0;i<this.optionList.length;++i){var s=this.optionList[i];this.isActive(s)&&t.extend(e,s)}return e.scope=e.scope||l.Parent,e.className=e.className||"stick",e.top=e.top||0,e.extraHeight=e.extraHeight||0,void 0===e.overflowScrolling&&(e.overflowScrolling=!0),e},u.prototype.store=function(){var t=this.element[0];this.origStyle={width:t.style.width,position:t.style.position,left:t.style.left,top:t.style.top,bottom:t.style.bottom,zIndex:t.style.zIndex}},u.prototype.restore=function(){this.element.css(this.origStyle)},u.prototype.bound=function(){var t=this.element;if(h||"border-box"!=t.css("box-sizing"))this.extraWidth=0;else{var e=parseFloat(t.css("border-left-width"))||0,i=parseFloat(t.css("border-right-width"))||0,s=parseFloat(t.css("padding-left"))||0,o=parseFloat(t.css("padding-right"))||0;this.extraWidth=e+i+s+o}this.margin={top:parseFloat(t.css("margin-top"))||0,bottom:parseFloat(t.css("margin-bottom"))||0,left:parseFloat(t.css("margin-left"))||0,right:parseFloat(t.css("margin-right"))||0},this.parent={border:{bottom:parseFloat(t.parent().css("border-bottom-width"))||0}}},u.prototype.precalculate=function(){this.baseTop=this.margin.top+this.options.top,this.basePadding=this.baseTop+this.margin.bottom,this.baseParentOffset=this.options.extraHeight-this.parent.border.bottom,this.offsetHeight=this.options.overflowScrolling?Math.max(this.element.outerHeight(!1)+this.basePadding-e,0):0,this.minOffsetHeight=-this.offsetHeight},u.prototype.reset=function(){this.stick==d?(this.trigger("unend"),this.trigger("unstick")):this.stick==p&&this.trigger("unstick"),this.stick=c,this.spacer.css("width",this.origStyle.width),this.spacer[0].style.cssText+=";display: none !important",this.restore(),this.element.removeClass(this.options.className)},u.prototype.setAbsolute=function(t){this.stick==c?(this.element.addClass(this.options.className),this.trigger("stick"),this.trigger("end")):this.trigger("end"),this.stick=d,this.element.css({width:this.element.width()+this.extraWidth+"px",position:"absolute",top:this.origStyle.top,left:t+"px",bottom:-this.options.extraHeight+"px","z-index":this.zIndex})},u.prototype.setFixed=function(t,e,i){this.stick==c?(this.element.addClass(this.options.className),this.trigger("stick")):this.trigger("unend"),this.options.overflowScrolling||(i=0),this.stick=p,this.lastY=e,this.offsetY=i,this.element.css({width:this.element.width()+this.extraWidth+"px",position:"fixed",top:this.options.top+i+"px",left:t+"px",bottom:this.origStyle.bottom,"z-index":this.zIndex})},u.prototype.updateScroll=function(t){if(0!=this.offsetHeight&&this.options.overflowScrolling){var e=Math.max(this.offsetY+t-this.lastY,this.minOffsetHeight);e=Math.min(e,0),this.lastY=t,this.offsetY!=e&&(this.offsetY=e,this.element.css("top",this.options.top+this.offsetY+"px"))}},u.prototype.isHeigher=function(){return this.options.scope==l.Parent&&this.element.parent().height()<=this.element.outerHeight(!1)+this.margin.bottom},u.prototype.locate=function(){if(this.activeKey){var t,e,i,s=this.element,o=this.spacer;switch(this.stick){case p:(e=(t=o[0].getBoundingClientRect()).top-this.baseTop)>=0||this.isHeigher()?this.reset():this.options.scope==l.Parent&&(t=s.parent()[0].getBoundingClientRect()).bottom+this.baseParentOffset+this.offsetHeight<=s.outerHeight(!1)+this.basePadding?this.setAbsolute(this.spacer.position().left):this.updateScroll(t.bottom);break;case d:e=(t=o[0].getBoundingClientRect()).top-this.baseTop,i=t.left-this.margin.left,e>=0||this.isHeigher()?this.reset():(t=s.parent()[0].getBoundingClientRect()).bottom+this.baseParentOffset+this.offsetHeight>s.outerHeight(!1)+this.basePadding&&this.setFixed(i+a,t.bottom,-this.offsetHeight);break;default:if((e=(t=s[0].getBoundingClientRect()).top-this.baseTop)>=0||this.isHeigher())return;var n=s.parent()[0].getBoundingClientRect();o.height(s.height()),o.show(),i=t.left-this.margin.left,this.options.scope==l.Document?this.setFixed(i,t.bottom,0):n.bottom+this.baseParentOffset+this.offsetHeight<=s.outerHeight(!1)+this.basePadding?this.setAbsolute(this.element.position().left):this.setFixed(i+a,t.bottom,0),o.width()||o.width(s.width())}}},u.prototype.refresh=function(){if(this.updateOptions(),this.bound(),this.precalculate(),this.stick!=c){var t=this.element,e=this.spacer;if(this.lastValues.width!=e.width()&&t.width(this.lastValues.width=e.width()),this.lastValues.height!=t.height()&&e.height(this.lastValues.height=t.height()),this.stick==p){var i=this.spacer[0].getBoundingClientRect().left-this.margin.left;this.lastValues.left!=i+"px"&&t.css("left",this.lastValues.left=i+"px")}this.locate()}else this.locate()},u.prototype.destroy=function(){this.reset(),this.spacer.remove(),this.element.removeData(s)},u.prototype.enableWillChange=function(t){"auto"==this.origWillChange&&this.element.css("will-change",t?"transform":this.origWillChange)};var w=["destroy","refresh"];t.fn.stickit=function(e,i){if("string"==typeof e){if(-1!=t.inArray(e,w)){var o=arguments;this.each((function(){var i=t(this).data(s);i&&i[e].apply(i,Array.prototype.slice.call(o,1))}))}}else{if(!f)if(f=!0,m(),t(document).ready((function(){t(window).bind("resize",m).bind("scroll",x),t(document.body).bind("animationend webkitAnimationEnd oAnimationEnd transitionend webkitTransitionEnd oTransitionEnd",x),t(document).bind("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",y)})),r)new MutationObserver(v).observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0});i=t.isArray(e)?e:Array.prototype.slice.call(arguments,0),this.each((function(){var e=new u(this,i);t(this).data(s,e),e.locate()}))}return this},t.stickit={refresh:b}}(jQuery);